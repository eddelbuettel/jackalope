<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Specify variation in mutation rates among sites — site_var • jackalope</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Specify variation in mutation rates among sites — site_var" />
<meta property="og:description" content="Construct necessary information for among-site variation in mutation rates that will
be used in create_variants." />
<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jackalope</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jackalope-intro.html">Intro to jackalope</a>
    </li>
    <li>
      <a href="../articles/sub-models.html">Models of nucleotide substitution</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/lucasnell/jackalope">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Specify variation in mutation rates among sites</h1>
    <small class="dont-index">Source: <a href='https://github.com/lucasnell/jackalope/blob/master/R/mevo.R'><code>R/mevo.R</code></a></small>
    <div class="hidden name"><code>site_var.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Construct necessary information for among-site variation in mutation rates that will
be used in <code>create_variants</code>.</p>
    </div>

    <pre class="usage"><span class='fu'>site_var</span>(<span class='no'>reference</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>region_size</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>invariant</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>mats</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>out_prefix</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>compress</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>comp_method</span> <span class='kw'>=</span> <span class='st'>"bgzip"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>reference</th>
      <td><p>A <code>ref_genome</code> object from which you will eventually
generate variants.</p></td>
    </tr>
    <tr>
      <th>shape</th>
      <td><p>Shape parameter for the Gamma distribution that generates gamma distances,
The variance of the distribution is <code>1 / shape</code>, and its mean is fixed to 1.
Values <code>&lt;= 0</code> are not allowed.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>region_size</th>
      <td><p>Size of regions to break the genome into,
where all sites within a region have the same gamma distance.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>invariant</th>
      <td><p>Proportion of regions that are invariant.
Must be in range <code>[0,1)</code>.
Defaults to <code>0</code>.</p></td>
    </tr>
    <tr>
      <th>mats</th>
      <td><p>List of matrices, one for each sequence in the genome.
Each matrix should have two columns.
The first should contain the end points for each region.
The second should contain the gamma distances for each region.
Note that if gamma distances don't have a mean (weighted by
sequence length for each gamma-distance value) equal to 1,
you're essentially changing the overall mutation rate.
If this argument is provided, <code>shape</code> and <code>region_size</code> are ignored.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>out_prefix</th>
      <td><p>String specifying the file name prefix for an output BED file that
will be generated by this function and that will specify the
gamma distances for each region.
If <code>NULL</code>, no output file is produced.
Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>compress</th>
      <td><p>Logical specifying whether or not to compress output file, or
an integer specifying the level of compression, from 1 to 9.
If <code>TRUE</code>, a compression level of <code>6</code> is used.
Defaults to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>comp_method</th>
      <td><p>Character specifying which type of compression to use if any
is desired. Options include <code>"gzip"</code> and <code>"bgzip"</code>.
This is ignored if <code>compress</code> is <code>FALSE</code>. Defaults to <code>"bgzip"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>site_var_mats</code> object, which is a wrapper around a list of matrices,
one for each sequence in the reference genome.
Although the print method is different, you can otherwise treat these objects
the same as you would a list (e.g., <code>x[[1]]</code>, <code>x[1:2]</code>, <code><a href='https://rdrr.io/r/base/length.html'>length(x)</a></code>).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A site's deviance from the average mutation rate is determined by its
"gamma distance".
A site's overall mutation rate is the mutation rate for that nucleotide
(substitution + indel) multiplied by the site's gamma distance.
There are two options for specifying gamma distances:</p><ol>
<li><p>Generate gamma distances from a Gamma distribution.
This method will be used if the <code>shape</code> and <code>region_size</code> arguments
are provided.
If the <code>mats</code> argument is also provided, this method will NOT be used.
See argument descriptions for more info.</p></li>
<li><p>Manually input matrices that specify the gamma distance and end points
for regions each gamma distance refers to.
This method will be used if the <code>mats</code> argument is provided.
See argument descriptions for more info.</p></li>
</ol>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='no'>ref</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='create_genome.html'>create_genome</a></span>(<span class='fl'>3</span>, <span class='fl'>100</span>)
<span class='co'># generating from Gamma distribution</span>
<span class='no'>gamma_mats</span> <span class='kw'>&lt;-</span> <span class='fu'>site_var</span>(<span class='no'>ref</span>, <span class='kw'>shape</span> <span class='kw'>=</span> <span class='fl'>0.5</span>,
                       <span class='kw'>region_size</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='co'># with custom matrices</span>
<span class='no'>gamma_mats</span> <span class='kw'>&lt;-</span> <span class='fu'>site_var</span>(<span class='no'>ref</span>,
                       <span class='kw'>mats</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>replicate</a></span>(<span class='fl'>3</span>,
                           <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>10</span>, <span class='fl'>100</span>, <span class='fl'>10</span>),
                           <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span>(<span class='fl'>10</span>, <span class='fl'>0.9</span>)),
                           <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>))</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lucas A. Nell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


